-- Suggest using http://sqlfiddle.com/ to deal with this database
-- Using Postgre SQL 9.6 Version

select *
from df1

select "Avg_class" as student, avg(math),avg(chinese),avg(english),avg(science),avg(society)
from df1




-- only select the column of student
SELECT DISTINCT student
FROM df1
WHERE 1=1 

-- culculate student's number
select count(student)
from df1
where 1=1

-- average score of the class
-- method01
select *
from df1
Union all
select 'avg_class' as student ,avg(math),avg(chinese),avg(english),avg(science),avg(society)
from df1

-- method02
select 'avg_class' as student ,avg(math),avg(chinese),avg(english),avg(science),avg(society)
from df1
union all
select *
from df1


-- how much students fail on math 
select count(math)
from df1
where math<=60

-- who fail on math (need to check check by Vic)
select name,avg(math)
  from df1
group by name
  having math<=60

-- inner join
select
  a.student,a.math,a.chinese,a.english,a.science,a.society
from df1 as a
  inner join df2
on a.student = df2.student;

-- full join
select
  df1.student,math,chinese,english,science,society
from df1
  full join df2
on df1.student = df2.student;

-- full join df1,df2,df3 (need to check by Vic)
select df1.student,math, chinese,english,sience,society
from df1
  full join df2
  on df1.student = df2.student
select df2.student,df2.performance,df2.overall,df2.conclusion
from df2
  full join df3
  on df2.overall = df3.overall
  
